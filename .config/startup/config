#/usr/bin/env bash

let count=0

# Verify if this script running in root or sudo
is_root() {
  if [ "$(id -u)" != "0" ]; then 
    echo "You need to be root!!!"
    exit 1
  else
    return
  fi
}

#Script to automatically run tasks
time_sync() {
  echo "Synchronizing time.  .  ."

  ntpd -qg
  if [ $? == 0 ];
  then 
    echo "Time Synchronizing ucessfully  !"
    let count+=1
  else
    error_message+="Can't syncronize time  !"
  fi
}

# mount HD in read-write format

mount_fs() {
  echo "Mounting files partition.  .  ."

  mount -o rw -t ntfs /dev/sda2 /home/Win
  if [ $? == 0 ]; then
    echo "Partition files mounted sucessfully!"

    let count+=1
  else
    echo = "Can't mount partition files  !"
  fi
}

update_packages() {
  echo "Updating system  !"

  pacman -Syyuu --noconfirm
  if [ $? == 0 ]; then
    echo "System updated sucessfully"
    
    let count+=1
  else
    echo="Error: Can't update packages!"
  fi
}

# Create file StartSystemCheck in /tmp to ~/.zshrc verify if the file system already monted before

system_check() {
  if [ $count -eq 3 ];
  then
    echo "Synchronizing complete  !"
    echo " Good codding   :)"
    touch /tmp/StartSystemCheck
  else
    echo "Synchronizing fails  !"
    echo " Go resolve it!!!"
    echo "Count number:  $count  !"
  fi
}

main() {
  is_root
  time_sync
  mount_fs
  update_packages
  system_check
}

main
